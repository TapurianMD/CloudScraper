<!-- Copyright Â© 2016, Xerxes Langerudi. All rights reserved. -->

<!doctype html>

<html>
<head>
	<title>CloudScraperBuilder</title>
</head>

<style>

.canvas
{
	float: right;
}

.menu
{
	width: 276px;
	height: 300px;
	font: 16px Verdana;
	float: left;
}

.header
{
	width: 276px;
	height: 50px;
	font-size: 25px;
}

.itemDescription
{
	width: 276px;
	float: left;
}

.itemHolder
{
	width: 276px;
	float: left;
}

select
{
	width: 140px;
}

</style>

<body>
	<form>
	<div class="menu">
		<div class="header">
		CloudScraper Builder
		</div>

		<div class="itemDescription">
		Number of floors:
		</div>
		<div class="itemHolder">
			<select name="floorNumbers" id="floorNumbers">
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5</option>
				<option value="6">6</option>
				<option value="7">7</option>
				<option value="8">8</option>
				<option value="9">9</option>
				<option value="10">10</option>
			</select>
		</div>

		<div class="itemDescription">
		Width:
		</div>
		<div class="itemHolder">
			<select name="width" id="width">
				<option value="10">10</option>
				<option value="11">11</option>
				<option value="12">12</option>
				<option value="13">13</option>
				<option value="14">14</option>
				<option value="15">15</option>
				<option value="16">16</option>
				<option value="17">17</option>
				<option value="18">18</option>
				<option value="19">19</option>
				<option value="20">20</option>
				<option value="21">21</option>
				<option value="22">22</option>
				<option value="23">23</option>
				<option value="24">24</option>
				<option value="25">25</option>
				<option value="26">26</option>
				<option value="27">27</option>
				<option value="28">28</option>
				<option value="29">29</option>
				<option value="30">30</option>
			</select>
		</div>

		<div class="itemDescription">
		Color:
		</div>
		<div class="itemHolder">
			<select name="color" id="color">
				<option value="Cool">Cool</option>
				<option value="Hot">Hot</option>
			</select>
		</div>

		<div class="itemDescription">
		Type:
		</div>
		<div class="itemHolder">
			<select name="type" id="type">
				<option value="Trade Center">Trade Center</option>
				<option value="Research Center">Research Center</option>
				<option value="Hospital">Hospital</option>
				<option value="University">University</option>
				<option value="Central Command">Central Command</option>
				<option value="Hotel">Hotel</option>
				<option value="Residential">Residential</option>
				<option value="Brothel">Brothel</option>
			</select>
		</div>

		<div class="itemDescription">
		Show:
		</div>
		<div class="itemHolder">
			<select name="show" id="show">
				<option value="All">All</option>
				<option value="Plumping">Plumping</option>
				<option value="Wiring">Wiring</option>
				<option value="Lamps">Lamps</option>
				<option value="Structure">Structure</option>
			</select>
		</div>

		<div class="itemDescription">
		Security:
		</div>
		<div class="itemHolder">
			<select name="security" id="security">
				<option value="Optimism">Optimism</option>
				<option value="Special forces">Special forces</option>
				<option value="Tank">Tank</option>
				<option value="Helicopter">Helicopter</option>
				<option value="CCTV">CCTV</option>
				<option value="Paranoia">Paranoia</option>
			</select>
		</div>
	</div>
</form>

<canvas width="653" height="650" class="canvas" id="canvas"></canvas>

<script type="text/javascript">

myCanvasX = 653;
myCanvasY = 650;

var windowColor;
var doorColor;
var wallColor;
var firstFloorWallColor;
var bannerColor;
var bannerTextColor;

var canvas = document.querySelector("#canvas");
var cx = canvas.getContext("2d");

function setColor(color)
{
	if (color == "Cool")
	{
		windowColor = "turquoise";
		doorColor = "turquoise";
		wallColor = "cyan";
		firstFloorWallColor = "grey";
		bannerColor = "lavender";
		bannerTextColor = "grey";
	}
	else
	{
		windowColor = "turquoise";
		doorColor = "turquoise";
		wallColor = "pink";
		firstFloorWallColor = "fuchsia";
		bannerColor = "lavender";
		bannerTextColor = "grey";
	}
}

function drawRoof(x, y, width, height, type)
{
	cx.fillStyle = bannerColor;
	cx.fillRect(x, y, width, height);
	cx.strokeStyle = "white";
	cx.strokeRect(x, y, width, height);

	type = "Cloud " + type;

	// Determine font size that can fit on the wall size
	var fontPX = width / type.length * 1.5

	// Max font size
	fontPX = fontPX > 30? 30 : fontPX;

	// Banner text
	cx.fillStyle = bannerTextColor;
	cx.font = fontPX + "px Verdana";
	cx.fillText(type, x + 10, y + 30);
}

function drawFloor(x, y, width, height, show)
{
	switch (show)
	{
		case "All":
			cx.fillStyle = wallColor;
			cx.fillRect(x, y, width, height);
			cx.strokeStyle = "white";
			cx.strokeRect(x, y, width, height);

			// Window
			cx.fillStyle = windowColor;

			var windowWidth = width / 2 - 6;

			cx.fillRect(x + 4, y, width / 2 - 6, height / 2);

			cx.fillRect(x + 4 + windowWidth + 4, y, windowWidth, height / 2);
		break;
		case "Plumping":
			cx.fillStyle = "blue";

			// Upward
			cx.fillRect(x + 5, y, 5, height);


			// Crosswise
			cx.fillRect(x, y + height, width, 5);
		break;
		case "Wiring":
			cx.fillStyle = "red";

			// Upward
			cx.fillRect(x + 2, y, 2, height);


			// Crosswise
			cx.fillRect(x, y + height, width, 2);
		break;
		case "Lamps":
			cx.fillStyle = "gold";

			// Roof
			for (myI = x; myI < (x + width); myI = myI + 40)
			{
				cx.fillRect(myI, y, 8, 2);			
			}
		break;
		case "Structure":
			cx.fillStyle = "grey";

			// Pillar 1
			cx.fillRect(x, y, 20, height);

			// Pillar 2
			cx.fillRect(x + width - 20, y, 20, height);

			// Crosswise
			cx.fillRect(x, y, width, 10);
		break;
	}
}

function drawFirstFloor(x, y, width, height, floorNumber)
{
	cx.fillStyle = firstFloorWallColor;
	cx.fillRect(x, y, width, height);

	// Determine door height and width based on building size
	var doorHeight = height / 1.5 + floorNumber * 1;
	var doorWidth = 25 + (floorNumber * 5);

	// Door
	cx.fillStyle = doorColor;
	cx.fillRect(x + 10, y + height - doorHeight, doorWidth, doorHeight);
}


function drawBuilding(foundationY, x, y, floorNumber, type, color, show)
{
	// Clear clouds
	cx.fillStyle = "white";
	cx.fillRect(0, 0, myCanvasX, myCanvasY);


	// Max width allowed
	cx.fillStyle = "white";
	cx.fillRect(0, 0, myCanvasX, myCanvasY);

	// Max width allowed
	x = x > 300? 300 : x;

	// min width allowed
	x = x < 100? 100 : x;

	// Max height per floor allowed
	y = y > 50? 50 : y;

	// Min height per floor allowed
	y = y < 40? 40 : y;

	// Max floors allowed
	floorNumber = floorNumber > 10? 10 : floorNumber;

	// Min floors allowed
	floorNumber = floorNumber < 1? 1 : floorNumber;

	width = x;
	height = y;
	
	x = (myCanvasX / 2) - (x / 2)

	setColor(color);

	drawFirstFloor(x, foundationY, width, height, floorNumber)

	for (i = 0; i < floorNumber; i++)
	{
		drawFloor(x, foundationY - y - (i * y), width, height, show)
	}

	drawRoof(x, foundationY - y - (i * y), width, height, type);
}


function drawTank(x, y)
{
	var size = 1;

	// Firearms
	cx.beginPath();
	cx.moveTo(x + 55 * size, y + 10 * size);
	cx.lineTo(x + 55 * size, y);
	cx.lineTo(x + 25 * size, y);
	cx.lineTo(x + 65 * size, y);

	cx.stroke();

	// Weapon mounter
	cx.beginPath();
	cx.moveTo(x + 35 * size, y + 20 * size);
	cx.lineTo(x + 45 * size, y + 10 * size);
	cx.lineTo(x + 65 * size, y + 10 * size);
	cx.lineTo(x + 75 * size, y + 20 * size);

	cx.stroke();

	// Body
	cx.beginPath();
	cx.moveTo(x, y + 40 * size);
	cx.lineTo(x + 25 * size, y + 20 * size);
	cx.lineTo(x + 85 * size, y + 20 * size);
	cx.lineTo(x + 110 * size, y + 40 * size);
	cx.lineTo(x + 95 * size, y + 60 * size);
	cx.lineTo(x + 15 * size, y + 60 * size);
	cx.lineTo(x, y + 40 * size);

	cx.stroke();

	// 1st wheel
	cx.beginPath();
	cx.arc(x + 15 * size, y + 75 * size, 10 * size, 0, 7);
	cx.fill();

	// 2nd wheel
	cx.beginPath();
	cx.arc(x + 40 * size, y + 75 * size, 10 * size, 0, 7);
	cx.fill();

	// 3rd wheel
	cx.beginPath();
	cx.arc(x + 65 * size, y + 75 * size, 10 * size, 0, 7);
	cx.fill();

	// 4th wheel
	cx.beginPath();
	cx.arc(x + 90 * size, y + 75 * size, 10 * size, 0, 7);
	cx.fill();

	// Front chain
	cx.beginPath();
	cx.arc(x + 10 * size, y + 75 * size, 12 * size, 1.8, 4.5);
	cx.stroke();

	cx.lineTo(x + 98 * size, y + 63 * size);
	cx.stroke();

	// End chain
	cx.beginPath();
	cx.arc(x + 95 * size, y + 75 * size, 12 * size, 5, 7.6);
	cx.stroke();

	cx.lineTo(x + 7 * size, y + 87 * size);
	cx.stroke();
}


var inXPrevious;
var inYPrevious

var shakeSize = 2;

var rotator = 1;
var backRotorCounter = 1;

function drawHelicopter(inX, inY)
{
	var size = 1;

	// When parameters change
	if (inXPrevious != inX || inYPrevious != inY)
	{
		inXPrevious = inX;
		inYPrevious = inY;
	
		x = inX;
		y = inY;
	}

	// Clear clouds
	cx.fillStyle = "white";

	// X: Rotor
	// Y: Rotor - 1
	// X: Empiric
	// Y: Empiric
	cx.fillRect(	(x + 60 - (size * 60)),
			(y + 35 - (35 * size)) - 1,
			140 * size,
			102 * size);

	// Shaking effect
	y == inY ? y = y + shakeSize : y = y - shakeSize;

	// Rotor
	cx.beginPath();
	cx.moveTo(x + 60 - (size * 60), y + 35 - (35 * size));
	cx.lineTo(x + 60 + (size * 60), y + 35 - (35 * size));

	// Rotation effect
	rotator = rotator == 1? 0 : 1;

	rotator == 1? cx.stroke() : 0;


	// Rotor holder
	cx.beginPath();
	cx.moveTo(x + 60, y + 35 - (25 * size));
	cx.lineTo(x + 60, y + 35 - (35 * size));
	cx.stroke();

	// Body
	cx.beginPath();
	cx.arc(x + 60, y + 35, 25 * size, 0, 7);
	cx.stroke();

	// Back rotor
	cx.beginPath();
	cx.fillStyle = "black";
	cx.moveTo(x + 60 + 70 * size, y + 35);
	cx.arc(x + 60 + 70 * size, y + 35, 10 * size, 0 + backRotorCounter, 0.2 + backRotorCounter);
	cx.arc(x + 60 + 70 * size, y + 35, 10 * size, 3 + backRotorCounter, 3.2 + backRotorCounter);
	cx.fill();

	backRotorCounter = backRotorCounter > 7? 0 : ++backRotorCounter;

	// Back rotor holder
	cx.beginPath();
	cx.moveTo((x + 60 + 25 * size), y + 35);
	cx.lineTo(x + 60 + 70 * size, y + 35);
	cx.stroke();

	// Ordnance holder
	cx.beginPath();
	cx.moveTo(x + 60, y + 35 + 25 * size);
	cx.lineTo(x + 60, y + 35 + 50 * size);
	cx.stroke();

	// Ordnance
	cx.beginPath();
	cx.moveTo(x + 60 + 20 * size, y + 35 + 25 * size);
	cx.lineTo(x + 60 - 30 * size, y + 35 + 65 * size);
	cx.stroke();
}

function drawCCTV(y, width, floorHeight, floorNumbers)
{
	var x = (myCanvasX / 2) - (width / 2);
	var buildingHeight = floorHeight + floorHeight * floorNumbers;

	var CCTVX = y - buildingHeight;

	// Right
	cx.beginPath();
	cx.moveTo(x + width, CCTVX);
	cx.lineTo(x + width + 10, CCTVX);
	cx.lineTo(x + width + 10, CCTVX + 10);
	cx.stroke();

	cx.beginPath();
	cx.arc(x + width + 10, CCTVX + 10, 7, 6.3, 3);
	cx.fill();

	// Left
	cx.beginPath();
	cx.moveTo(x, CCTVX);
	cx.lineTo(x - 10, CCTVX);
	cx.lineTo(x - 10, CCTVX + 10);
	cx.stroke();

	cx.beginPath();
	cx.arc(x - 10, CCTVX + 10, 7, 6.3, 3);
	cx.fill();
}

var airPatrol;

function drawSecurity(security, y, width, floorHeight, floorNumbers)
{
	cx.strokeStyle = "black";
	cx.fillStyle = "black";

	if (security == "Optimism")
	{
		// No security
	}
	if (security == "Special forces" || security == "Paranoia")
	{
		// Hidden in undisclosed place
	}
	if (security == "Tank" || security == "Paranoia")
	{
		// Patroling
		drawTank(15, 500);
	}
	if (security == "Helicopter" || security == "Paranoia")
	{
		// Might already be set
		clearInterval(airPatrol);

		// Patroling
		airPatrol = setInterval(function()
		{
			drawHelicopter(490, 65);
		}, 50);
	}
	else
	{
		clearInterval(airPatrol);
	}
	if (security == "CCTV" || security == "Paranoia")
	{
		// Roof mounted
		drawCCTV(y, width, floorHeight, floorNumbers);
	}
}


var form = document.querySelector("form");

form.addEventListener("change", function()
{
	var width = form.elements.width.value * 10;
	var floorHeight = 50;
	var floorNumbers = form.elements.floorNumbers.value;
	var color = form.elements.color.value;
	var type = form.elements.type.value;
	var show = form.elements.show.value;
	var security = form.elements.security.value;

	drawBuilding(550, width, floorHeight, floorNumbers, type, color, show);

	drawSecurity(security, 550, width, floorHeight, floorNumbers);
});

</script>

</body>
</html>

